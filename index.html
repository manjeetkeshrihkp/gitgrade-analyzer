<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GitGrade AI</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

* { box-sizing: border-box; }

body {
  font-family: 'Inter', sans-serif;
  background: radial-gradient(circle at top, #7f7cff, #1f1c2c);
  min-height: 100vh;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
}

.glass {
  background: rgba(255,255,255,0.12);
  backdrop-filter: blur(18px);
  border-radius: 20px;
  padding: 35px;
  width: 480px;
  box-shadow: 0 25px 60px rgba(0,0,0,0.4);
}

h1 {
  text-align: center;
  color: #fff;
  margin-bottom: 6px;
}

.subtitle {
  text-align: center;
  color: #ddd;
  font-size: 13px;
  margin-bottom: 22px;
}

input {
  width: 100%;
  padding: 14px;
  border-radius: 12px;
  border: none;
  outline: none;
  font-size: 14px;
}

button {
  width: 100%;
  padding: 14px;
  margin-top: 14px;
  border-radius: 12px;
  border: none;
  background: linear-gradient(135deg, #7f7cff, #5f5bff);
  color: white;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
}

.output {
  margin-top: 20px;
  background: rgba(255,255,255,0.95);
  border-radius: 14px;
  padding: 18px;
  font-size: 13px;
  color: #222;
  white-space: pre-wrap;
}

.badge {
  display: inline-block;
  background: #5f5bff;
  color: white;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 11px;
  margin-bottom: 10px;
}

.footer {
  text-align: center;
  margin-top: 18px;
  font-size: 11px;
  color: #ccc;
}
</style>
</head>

<body>

<div class="glass">
  <h1>GitGrade AI</h1>
  <div class="subtitle">Real GitHub Repository Analysis</div>

  <input id="repoUrl" placeholder="https://github.com/username/repository">
  <button onclick="analyzeRepo()">Analyze Repository</button>

  <div id="result" class="output"></div>

  <div class="footer">Made with ‚ù§Ô∏è By Manjeet Keshri</div>
</div>

<script>
async function analyzeRepo() {
  const input = document.getElementById("repoUrl").value.trim();
  const result = document.getElementById("result");

  if (!input.startsWith("https://github.com/")) {
    result.textContent = "‚ùå Please enter a valid GitHub repository URL.";
    return;
  }

  let cleanUrl = input.replace(/\/+$/, "").replace(".git", "");
  const parts = cleanUrl.split("/");

  if (parts.length < 5) {
    result.textContent = "‚ùå Invalid GitHub repository URL format.";
    return;
  }

  const owner = parts[3];
  const repo = parts[4];

  result.innerHTML = "<span class='badge'>Analyzing</span>\n\nFetching repository data...";

  try {
    const repoRes = await fetch(`https://api.github.com/repos/${owner}/${repo}`);

    // üî• CORRECT ERROR HANDLING
    if (repoRes.status === 404) {
      result.textContent = "‚ùå Repository not found. Please check the URL.";
      return;
    }

    if (repoRes.status === 403) {
      result.textContent =
        "‚ö†Ô∏è GitHub API rate limit exceeded.\n\n" +
        "Please wait 1‚Äì2 minutes or try again later.\n\n" +
        "This happens because GitHub limits anonymous requests.";
      return;
    }

    if (!repoRes.ok) {
      result.textContent = "‚ùå Unable to fetch repository data.";
      return;
    }

    const repoData = await repoRes.json();

    const commitsRes = await fetch(
      `https://api.github.com/repos/${owner}/${repo}/commits?per_page=100`
    );
    const commits = commitsRes.ok ? await commitsRes.json() : [];

    const readmeRes = await fetch(
      `https://api.github.com/repos/${owner}/${repo}/readme`
    );
    const hasReadme = readmeRes.ok;

    let score = 0;
    let details = [];
    let roadmap = [];

    if (repoData.description) {
      score += 10;
      details.push("‚úî Repository has a description.");
    } else {
      roadmap.push("Add a clear project description.");
    }

    if (repoData.language) {
      score += 10;
      details.push(`‚úî Primary language: ${repoData.language}.`);
    } else {
      roadmap.push("Define the main programming language.");
    }

    if (hasReadme) {
      score += 15;
      details.push("‚úî README file is present.");
    } else {
      roadmap.push("Add a README with setup and usage instructions.");
    }

    if (commits.length >= 20) {
      score += 25;
      details.push("‚úî Strong commit consistency.");
    } else if (commits.length >= 5) {
      score += 15;
      details.push("‚úî Moderate commit activity.");
      roadmap.push("Increase commit frequency.");
    } else {
      roadmap.push("Very few commits. Commit regularly.");
    }

    if (repoData.stargazers_count >= 5) {
      score += 20;
      details.push("‚úî Community interest detected.");
    } else {
      roadmap.push("Improve usefulness to gain stars.");
    }

    if (repoData.open_issues_count === 0) {
      score += 10;
      details.push("‚úî No open issues.");
    } else {
      roadmap.push("Resolve or manage open issues.");
    }

    const level =
      score >= 80 ? "Advanced" :
      score >= 50 ? "Intermediate" : "Beginner";

    result.innerHTML =
      `<span class="badge">Score: ${score}/100 (${level})</span>\n\n` +
      `üìä Detailed Analysis:\n- ${details.join("\n- ")}\n\n` +
      `üß† Summary:\nThis repository is classified as ${level} based on real GitHub data.\n\n` +
      `üõ†Ô∏è Improvement Roadmap:\n- ${roadmap.join("\n- ")}`;

  } catch (err) {
    result.textContent =
      "‚ùå Network error.\n\nPlease check your internet connection and try again.";
  }
}
</script>

</body>
</html>
